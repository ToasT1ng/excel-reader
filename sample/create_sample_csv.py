#!/usr/bin/env python3
import csv
from datetime import datetime, date

def create_sample_csv():
    """샘플 CSV 파일 생성"""

    # 헤더
    headers = ["이름", "나이", "부서", "직급", "연봉", "입사일", "최근 로그인", "재직여부"]

    # 데이터
    data = [
        ["김철수", "32", "개발팀", "대리", "5500", "2020-03-15", "2025-12-08 09:30:00", "true"],
        ["이영희", "28", "마케팅팀", "사원", "4200", "2022-06-01", "2025-12-08 08:45:00", "true"],
        ["박민수", "35", "개발팀", "과장", "7000", "2018-01-10", "2025-12-07 18:20:00", "true"],
        ["정수진", "30", "인사팀", "대리", "5200", "2021-09-20", "2025-12-08 10:15:00", "true"],
        ["최동욱", "42", "영업팀", "부장", "9000", "2015-04-05", "2025-12-08 07:30:00", "true"],
        ["강민지", "26", "디자인팀", "사원", "4000", "2023-03-01", "2025-12-08 09:00:00", "true"],
        ["윤서현", "33", "개발팀", "과장", "6800", "2019-07-15", "2025-12-08 08:00:00", "true"],
        ["한지훈", "29", "마케팅팀", "대리", "5300", "2021-11-10", "2025-12-08 09:45:00", "true"],
        ["오현아", "31", "영업팀", "대리", "5600", "2020-05-20", "2025-12-07 17:30:00", "true"],
        ["임태양", "38", "개발팀", "차장", "8200", "2016-08-01", "2025-12-08 08:30:00", "true"]
    ]

    # CSV 파일 작성
    with open("sample/직원정보.csv", "w", newline="", encoding="utf-8") as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(data)

    print("✅ 샘플 CSV 파일이 생성되었습니다: sample/직원정보.csv")
    print(f"총 {len(data)}개의 데이터 행")


def create_edge_case_csv():
    """Edge case CSV 파일 생성"""

    headers = ["이름", "나이", "부서", "직급", "연봉", "입사일", "최근 로그인", "재직여부"]

    # Edge case 데이터
    data = [
        # 1. 정상 데이터
        ["김철수", "32", "개발팀", "대리", "5500", "2020-03-15", "2025-12-08 09:30:00", "true"],

        # 2. 나이가 "28세"로 되어있는 경우
        ["이영희", "28세", "마케팅팀", "사원", "4200", "2022-06-01", "2025-12-08 08:45:00", "true"],

        # 3. 연봉이 쉼표 포함
        ["박민수", "35", "개발팀", "과장", "7,000원", "2018-01-10", "2025-12-07 18:20:00", "true"],

        # 4. null 값 (빈 문자열)
        ["정수진", "", "인사팀", "대리", "5200", "2021-09-20", "2025-12-08 10:15:00", ""],

        # 5. Boolean이 다양한 형식
        ["최동욱", "42", "영업팀", "부장", "9000", "2015-04-05", "2025-12-08 07:30:00", "Yes"],
        ["강민지", "26", "디자인팀", "사원", "4000", "2023-03-01", "", "1"],
        ["윤서현", "33", "개발팀", "과장", "6800", "2019-07-15", "2025-12-08 08:00:00", "FALSE"],

        # 6. 공백 포함 숫자
        ["한지훈", "  29  ", "마케팅팀", "대리", "  5300  ", "2021-11-10", "2025-12-08 09:45:00", "true"],

        # 7. 음수 나이
        ["박음수", "-5", "영업팀", "사원", "4000", "2024-01-01", "2025-12-08 09:00:00", "true"],

        # 8. 큰 숫자
        ["정억만", "50", "임원", "사장", "999999999", "2005-01-01", "2025-12-08 07:00:00", "true"],

        # 9. 0 값
        ["최제로", "0", "인턴팀", "인턴", "0", "2025-12-01", "2025-12-08 10:00:00", "0"],

        # 10. 쉼표가 포함된 필드 (따옴표로 감싸기)
        ["이쉼표", "30", "개발팀, 마케팅팀", "대리", "5500", "2020-01-01", "2025-12-08 09:00:00", "true"],
    ]

    with open("sample/직원정보_edge_cases.csv", "w", newline="", encoding="utf-8") as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(data)

    print("✅ Edge case CSV 파일이 생성되었습니다: sample/직원정보_edge_cases.csv")
    print(f"총 {len(data)}개의 데이터 행")
    print("\n포함된 Edge Cases:")
    print("  1. 정상 데이터")
    print("  2. 나이가 문자열 ('28세')")
    print("  3. 연봉이 쉼표 포함 ('7,000원')")
    print("  4. null 값 (빈 문자열)")
    print("  5-7. Boolean 다양한 형식 (Yes, 1, FALSE)")
    print("  8. 공백 포함 숫자")
    print("  9. 음수 나이")
    print("  10. 큰 숫자")
    print("  11. 0 값")
    print("  12. 쉼표가 포함된 필드")


if __name__ == "__main__":
    create_sample_csv()
    print()
    create_edge_case_csv()
